define(function(require,exports,module){function $(t,i){i=i||document;var e,o=[],n=d.exec(t);if(n){if(n[1]&&i.getElementById)return e=i.getElementById(n[1]),e&&o.push(e),o;if(n[2]&&i.getElementsByClassName)return e=i.getElementsByClassName(n[2]),e&&e.length&&u.apply(o,e),o;if(n[3]&&i.getElementsByTagName)return e=i.getElementsByClassName(n[3]),e&&e.length&&u.apply(o,e),o}return i.querySelectorAll&&u.apply(o,i.querySelectorAll(t)),o}function t(t,i){return window.getComputedStyle?window.getComputedStyle(t)[i]:t.currentStyle?t.currentStyle[i]:void 0}function i(i,e,o){return o?void(i.style[e]=o):t(i,e)}function e(t,i,e){t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent&&(t["__on"+i+"__"]=e,t.attachEvent("on"+i,t["__on"+i+"__"]))}function o(t){return{pageWidth:t.scrollWidth,pageHeight:t.scrollHeight,height:t.clientHeight,width:t.clientWidth,top:t.scrollTop,left:t.scrollLeft}}function n(t){t.preventDefault&&t.preventDefault(),"returnValue"in t&&(t.returnValue=!1)}function s(t){t.stopPropagation&&t.stopPropagation(),"cancelBubble"in t&&(t.cancelBubble=!0)}function r(t,i){return t===i||i.compareDocumentPosition&&!!(16&i.compareDocumentPosition(t))||i.contains&&i.contains(t)}function l(){this.times=[],this.state=l.STATE_STOP,this.timer,this.curX,this.curY,this.resource}function h(){}function c(t){this.html,this.container,this.el,this.xScrollBar,this.yScrollBar,this.xScrollBarMargin=1,this.yScrollBarMargin=1,this.startX=0,this.startY=0,this.startScrollX=0,this.startScrollY=0,this.acceleration=new l,this.slide_state=c.SLIDE_STATE_STOP,this.lastLeft,this.lastTop,this.onScrollStart=h,this.onScrollMove=h,this.onScrollEnd=h,this.hideScroller=!1,this.curXRatio=1,this.curYRatio=1,this._onTouchStart=this.onTouchStart.bind(this),this._onTouchMove=this.onTouchMove.bind(this),this._onTouchEnd=this.onTouchEnd.bind(this),this.isLeftBtnDown=!1,this._ieOnTouchStart=function(t){t=window.event||t,r(t.target||t.srcElement,this.el)&&(0===t.button||p&&1===t.button)&&(this.isLeftBtnDown=!0,this.onTouchStart(t))}.bind(this),this._ieOnTouchMove=function(t){t=window.event||t,(0===t.button||p&&1===t.button)&&this.isLeftBtnDown&&this.onTouchMove(t)}.bind(this),this._ieOnTouchEnd=function(t){t=window.event||t,(0===t.button||p&&1===t.button)&&this.isLeftBtnDown&&(this.onTouchEnd(t),this.isLeftBtnDown=!1)}.bind(this),this.curThreadId=0,this.events={},this.setOption(t),this.init()}var a=Array.prototype,u=(a.slice,a.push),d=/^#([a-z][\w-]+)|\.([a-z][\w-]+)|([a-z]+)/i,S=/^[a-z]+$/i,p=!!document.attachEvent;Function.prototype.bind=Function.prototype.bind||function(t){var i=this;return function(){return i.apply(t,arguments)}};var f=function(t){return function(i,o,n){var s=null;if(S.test(i))s=document.createElement(i);else{t.innerHTML=i;var r=t.firstChild;t:do if(r&&1===r.nodeType){t.removeChild(r),t.innerHTML="",s=r;break t}while(r=r.nextSibling)}o=o||{};var l;for(var h in o)l=o[h],"class"===h&&(h="className"),"style"===h?s[h].cssText=l:s[h]=l;n=n||{};for(var h in n)e(s,h,n[h]);return s}}(document.createElement("div")),T=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){setTimeout(t,1e3/60)};l.STATE_STOP=0,l.STATE_RUNNING=1,l.prototype={constructor:l,start:function(t,i){this.add(t,i),this.state=l.STATE_RUNNING,this.loop()},loop:function(){this.state!==l.STATE_STOP&&(this.add(this.curX,this.curY),this.timer=setTimeout(this.loop.bind(this),25))},add:function(t,i){return this.state=l.STATE_RUNNING,clearTimeout(this.timer),this.times.unshift({time:(new Date).valueOf(),x:t,y:i}),this.curX=t,this.curY=i,this.times.length>5&&this.times.splice(5,this.times.length-5),this.timer=setTimeout(this.loop.bind(this),25),this.calc()},end:function(t,i){return this.add(t,i),this.state=l.STATE_STOP,clearTimeout(this.timer),this.calc()},calc:function(){var t=3,i=this.times,e=i[t]||i[t-1]||i[t-2],o=i[0];if(!e)return{x:0,y:0};var n=o.time-e.time,s=o.x-e.x,r=o.y-e.y,l=1e3/n*s,h=1e3/n*r;return{x:l,y:h}}};var m="ontouchstart"in document,p="attachEvent"in document,g="xscroll-";return c.SLIDE_STATE_STOP=0,c.SLIDE_STATE_RUNNING=1,c.prototype={constructor:c,setOption:function(t){if(t.el)if("string"==typeof t.el){if(this.el=$(t.el)[0],!this.el)throw"element does not exist!"}else this.el=t.el;t.onSrcollStart&&"function"==typeof t.onSrcollStart&&(this.onScrollStart=t.onSrcollStart),t.onScrollMove&&"function"==typeof t.onScrollMove&&(this.onScrollMove=t.onScrollMove),t.onScrollEnd&&"function"==typeof t.onScrollEnd&&(this.onScrollEnd=t.onScrollEnd),"undefined"!=typeof t.hideScroller&&(this.hideScroller=t.hideScroller),"undefined"!=typeof t.xScrollBarMargin&&(this.xScrollBarMargin=t.xScrollBarMargin),"undefined"!=typeof t.yScrollBarMargin&&(this.yScrollBarMargin=t.yScrollBarMargin)},init:function(){this.buildEvent(),this.createScrollBar(),this.calcScroll(),this._onScrollEnd()},buildEvent:function(){m?(e(this.el,"touchstart",this._onTouchStart),e(this.el,"touchmove",this._onTouchMove),e(this.el,"touchend",this._onTouchEnd)):(e(document.documentElement,"mousedown",this._ieOnTouchStart),e(document.documentElement,"mousemove",this._ieOnTouchMove),e(document.documentElement,"mouseup",this._ieOnTouchEnd))},scrollTo:function(t,i){this.setScroll(t,i)},getPointerPos:function(t){var i;return i=m?t&&t.changedTouches&&t.changedTouches[0]:t},getTouchPos:function(t){var i=this.getPointerPos(t);return i?{x:i.screenX,y:i.screenY}:{x:0,y:0}},setStartPos:function(t){var i=this.getTouchPos(t),e=o(this.container);this.startX=i.x,this.startY=i.y,this.startScrollX=e.left,this.startScrollY=e.top},getNewPos:function(t){var i=this.getTouchPos(t),e=this.startScrollX+(this.startX-i.x),o=this.startScrollY+(this.startY-i.y);return{x:e,y:o}},getPageTouchPos:function(t){var i=this.getPointerPos(t);return{x:i.screenX,y:i.screenY}},onTouchStart:function(t){s(t),this.setStartPos(t);var i=this.getPageTouchPos(t);this.acceleration.add(i.x,i.y),this.stopSlideLoop(),this.onScrollStart()},onTouchMove:function(t){this._onScrollMove(),n(t),s(t);var i=this.getNewPos(t);this.setScroll(i.x,i.y);var e=this.getPageTouchPos(t);this.acceleration.add(e.x,e.y)},onTouchEnd:function(t){s(t);var i=this.getPageTouchPos(t),e=this.acceleration.end(i.x,i.y);(e.y||e.x)&&this.startSlide(e)},startSlide:function(t){this.slide_state=c.SLIDE_STATE_RUNNING;var i=parseInt(.03*Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)));this.slideLoop(60+i,60+i,this.curThreadId,t.x,t.y)},slideLoop:function(t,i,e,n,s){if(clearTimeout(this.endtimeer),e===this.curThreadId){if(!t||!n&&!s)return this.slide_state=c.SLIDE_STATE_STOP,this.onScrollEnd(),void(this.endtimeer=setTimeout(this._onScrollEnd.bind(this),400));var r=o(this.container);if(r.left===this.lastLeft&&r.top===this.lastTop)return this.slide_state=c.SLIDE_STATE_STOP,this.onScrollEnd(),void(this.endtimeer=setTimeout(this._onScrollEnd.bind(this),400));var l=.03*Math.pow(t/i,3),h=r.left-n*l,a=r.top-s*l;this.lastLeft=r.left,this.lastTop=r.top,this.calcSlidePos(h,a),T(function(){this.slideLoop(--t,i,e,n,s)}.bind(this))}},stopSlideLoop:function(){this.curThreadId++},calcSlidePos:function(t,i){this.setScroll(t,i)},setScroll:function(t,i){this.container.scrollTop=i,this.container.scrollLeft=t,this.calcScroll()},_onScrollMove:function(){this.hideScroller||(1!==this.curXRatio&&i(this.xScrollBar,"display","block"),1!==this.curYRatio&&i(this.yScrollBar,"display","block")),this.onScrollMove()},_onScrollEnd:function(){this.slide_state===c.SLIDE_STATE_STOP&&(i(this.xScrollBar,"display","none"),i(this.yScrollBar,"display","none"))},calcScroll:function(){var t=o(this.container),e=t.pageHeight-t.height,n=t.pageWidth-t.width,s=t.left/n||0,r=t.top/e||0,l=t.width/t.pageWidth,h=t.height/t.pageHeight,c=l*(t.width-2*this.xScrollBarMargin),a=h*(t.height-2*this.yScrollBarMargin),u=this.xScrollBarMargin+s*(t.width-2*this.xScrollBarMargin-c),d=this.yScrollBarMargin+r*(t.height-2*this.yScrollBarMargin-a);this.curXRatio=l,this.curYRatio=h,i(this.xScrollBar,"width",c+"px"),i(this.yScrollBar,"height",a+"px"),i(this.xScrollBar,"left",u+"px"),i(this.yScrollBar,"top",d+"px"),1===l&&i(this.xScrollBar,"display","none"),1===h&&i(this.yScrollBar,"display","none")},createScrollBar:function(){var t="position:absolute;height:5px;width:5px;background:#000;opacity:0.5;border-radius:2px; zoom:1;overflow:hidden;";this.container=f("div",{"class":g+"container",style:"height:100%;width:100%;overflow:hidden"}),this.xScrollBar=f("div",{"class":g+"xscrollbar",style:t+"left:"+this.xScrollBarMargin+"px;bottom:"+this.xScrollBarMargin+"px;"}),this.yScrollBar=f("div",{"class":g+"yscrollbar",style:t+"right:"+this.yScrollBarMargin+"px;top:"+this.yScrollBarMargin+"px;"});for(var e=[],o=0,n=this.el.childNodes.length;o<n;o++)e.push(this.el.childNodes[o]);for(o=0,n=e.length;o<n;o++)this.container.appendChild(e[o]);this.el.appendChild(this.container),this.el.appendChild(this.xScrollBar),this.el.appendChild(this.yScrollBar);var s=i(this.el,"position");s&&"static"!==s||i(this.el,"position","relative")},getContent:function(){return this.container}},c});